<div class="container">
  <div class="row">
    <div class="col-md-6">
      <div class="form-group">
        <label for="categoryFilter"></label>
        <select class="form-control" name="" id="categoryFilter" [(ngModel)]="filterByCategory">
          <option *ngFor="let category of categories" [ngValue]="category">{{category}}</option>
        </select>
      </div>
    </div>
    <div class="col-md-6">
      <label for="nameFilter"></label>
      <div class="form-group">
        <input type="text" class="form-control" id="nameFilter" name="nameFilter"
               [(ngModel)]="filterByName"/>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <div class="form-group">
        <label for="lowerPriceBound"></label>
        <input type="number" class="form-control" id="lowerPriceBound" name="lowerPriceBound"
               [(ngModel)]="lowerPriceBound"/>
      </div>
    </div>
    <div class="col-md-6">
      <label for="upperPriceBound"></label>
      <div class="form-group">
        <input type="number" class="form-control" id="upperPriceBound" name="upperPriceBound"
               [(ngModel)]="upperPriceBound"/>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-4 mb-2"
         *ngFor="let product of productList | async | filterByCategory: filterByCategory | filterByName: filterByName | lowerPriceBound: lowerPriceBound | upperPriceBound: upperPriceBound | paginate: { itemsPerPage: 2, currentPage: page }"
    >
      <div class="item">
        <div class=" mb-r">
          <!--Card-->
          <div class="card card-cascade  card-ecommerce wider">
            <!--Card image-->
            <div class="view view-cascade overlay">
              <img class="card-img-top" [src]="product.imageUrl"
                   alt="">
              <a>
                <div class="mask rgba-white-slight"></div>
              </a>
            </div>

            <div class="card-body card-body-cascade text-center">
              <!--Category & Title-->
              <h5>{{ product.category }}</h5>
              <h4 class="card-title"><strong><a href=""> {{product.name }} </a></strong></h4>

              <!--Description-->
              <p class="card-text">{{ product.description }}</p>

              <!--Card footer-->
              <div class="container">
                <div class="card-footer">
                  <span class="float-left">{{ product.price }} PLN</span>
                  <span class="float-right">
                    <a class="active" data-toggle="modal" data-target="#editProduct" data-placement="top" title="Edytuj"
                       *ngIf="getAuthService().hasAdminPermissions()"><i class="fa fa-edit" aria-hidden="true"></i></a>
                    <a class="active" data-toggle="tooltip" data-placement="top" title="Dodaj do koszyka"
                       *ngIf="isProductAvailable(product) && !(getAuthService().hasAdminPermissions() || getAuthService().hasManagerPermissions())"
                       (click)="addToCart(product)"><i class="fa fa-cart-plus"
                                                       aria-hidden="true"></i></a>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal fade" id="editProduct" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
          <div class="modal-dialog cascading-modal" role="document">
            <form [formGroup]="editForm" (ngSubmit)="edit(product)">
              <div class="modal-content">
                <div class="modal-header light-blue darken-3 white-text">
                  <h4 class="title">
                    <i class="fa fa-edit"></i> Edycja produktu </h4>
                  <button type="button" class="close waves-effect waves-light" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                  </button>
                </div>
                <div class="modal-body">


                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="name">Nazwa produktu</label>
                      <input type="text" class="form-control" id="name" name="name" formControlName="name"
                             placeholder={{product.name}}
                             value="" required>
                    </div>
                    <div class="col-md-6 mb-3">
                      <label for="category">Kategoria</label>
                      <input type="text" class="form-control" id="category" name="category"
                             formControlName="category"
                             placeholder={{product.category}} value="" required>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="description">Opis
                      <span class="text-muted">(opcjonalny)</span>
                    </label>
                    <textarea type="text" class="form-control" id="description" placeholder={{product.description}}
                              name="description"
                              formControlName="description"></textarea>
                  </div>

                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="price">Cena</label>
                      <input type="number" name="price" class="form-control" formControlName="price"
                             placeholder={{product.price}}
                             id="price" value="" required>
                      <div class="invalid-feedback">
                        Cena jest wymagana
                      </div>
                    </div>
                    <div class="col-md-6 mb-3">
                      <label for="quantity">Ilość</label>
                      <input type="number" class="form-control" id="quantity" name="quantity"
                             formControlName="quantity" placeholder={{product.quantity}}
                             value="" required>
                      <div class="invalid-feedback">
                        Ilość jest wymagana
                      </div>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="imageUrl">Zdjęcie</label>
                    <input type="text" class="form-control" id="imageUrl" formControlName="imageUrl"
                           name="imageUrl"
                           placeholder={{product.imageUrl}} required>
                  </div>


                  <div class="text-center mt-2">
                    <button class="btn btn-info waves-light" id="editButton" mdbRippleRadius
                            [disabled]="!editForm.valid">Zatwierdź<i class="fa fa-sign-in ml-1"></i>
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="text-center mt-3">
      <pagination-controls (pageChange)="page = $event"></pagination-controls>
    </div>
  </div>
</div>
